# Convex Hull

简单神经网络训练凸包的可视化工具。

## 0. 安装

### 0.1 Python env

运行需要 python 3.7

### 0.2 bimpy

UI 界面 使用 bimpy 实现。
由于官方版本不支持最新的 ImGui，请使用 [Solitry/bimpy](https://github.com/Solitry/bimpy)
并根据说明 **使用源码** 进行编译安装：
```bash
python(3) setup.py install
```

Clone bimpy 时需要同时 clone submodule:
```bash
git clone --recursive https://github.com/Solitry/bimpy.git
```

如果已经安装了 bimpy 0.0.13 版本，请使用 `pip(3) uninstall bimpy` 卸载。

### 0.3 Pytorch

项目中涉及神经网络的部分使用 Pytorch Stable(1.2) 版本，
请至官网安装 [Pytorch](https://pytorch.org/get-started/locally/)


## 1. 使用说明

### 1.1 运行

使用 python3 运行

```bash
python(3) entry.py
```

### 1.2 界面说明

主界面包含两个窗口 Canvas 和 Dash。

其中 Canvas 负责：

* 可视化绘制

* 用户绘制交互（凸包、直线）

Dash 负责：

* 凸包数据展示

* 训练设置数据展示

* 训练阶段数据展示

以下将根据 Dash 内从上至下的顺序说明功能。

### 1.3 特别说明

Dash 窗口内几乎所有东西都可以随意修改。

请注意几个通用 ~~bug~~ feature：

* 所有数值填写窗口可以使用科学记数法（e.g. 1e-2）

* 所有数值填写窗口需要 **回车** 进行确认，对于大部分用户，小键盘回车可能无效

* 训练开始、用户绘图（画凸包、画线）时，Dash 中几乎所有东西都会被锁定，无法进行修改

* `(?)` 标记用于说明该部分的一些详细信息，鼠标移动到该标记上方可以看到悬浮窗口

* 整个界面内玩坏了重启就可以恢复了，如果窗口移动到看不见的位置，删除 imgui.ini 文件，然后重启

### 1.4 凸包设置

convex setting 分栏内，可以设置凸包的参数。

+/- 按钮可以增减凸包点数，每个凸包点可以修改，但需要保证凸包为 逆时针 方向。

目前没有在程序中确保逆时针性质，如果直接修改凸包点，需要用户自行保证。

`draw convex` 按钮可以进行凸包绘制，点击后，可以在 Canvas 中进行绘制。

绘制的凸包使用紫色线条表示，可以使用如下鼠标操作：

* 左键单击：选择绘制一个点，绘制的点需要满足凸包性质，会根据新点击的点重新计算有效凸壳；
* 左键双击：选择绘制一个点（因为双击会触发一次单击），并结束绘制；
* 右键单击：取消当前的最后一个点；
* 右键双击：取消当前绘制；

绘制过程中，可以在 Dash 中看到点的数据。

如果用户取消绘制，或者绘制的凸包不满足要求，凸包会恢复绘制前的结果。

### 1.5 训练设置

train setting 分栏。

#### 1.5.1 线（半平面）设置

线在 Canvas 中用白色线表示，其距离正方向用半透明绿色表示半平面。

每条线使用 `ax + by + c = 0` 定义，Dash 中按照 `a, b, c` 顺序显示数值。

其中 `a, b, c` 没有进行归一化，定义 `(a, b)` 向量为到当前直线距离的正方向。

+/- 按钮可以增减线的数量，增加的线默认 `a = b = c = 0`，这样的线被认为是无效的线，
在 Canvas 中不进行绘制。

半平面通过直线与 `x = -100, x = +100, y = -100, y = 100` 4 条直线判交得到，
如果直线太远，同样不进行绘制。

`rev` 按钮可以将 `a, b, c` 取反，对应 Canvas 中半平面方向将反转。

`draw` 按钮可以开始直线绘制，点击后原有直线消失，在 Canvas 中拖拽进行绘制，目前没有取消绘制的功能。

鼠标在 Dash 中移动到线的相关位置，对应线将会高亮显示。

线的数量过多时，line value 分栏将会自动收起。


`random` 按钮可以随机所有直线。

展开 initilizer 分栏，可以进行随机策略选择，目前只有 torch 中 Linear Layer 使用的 kaiming 方法。

### 1.5.2 生成器设置

选择产生数据的生成器。

### 1.5.3 优化器设置

选择训练网络用的优化器，目前只有 Adam 和 SGD。

### 1.5.4 Loss 函数设置

选择训练网络用的 loss 函数。

### 1.5.5 训练设置

设置训练阶段需要的数据。

## 1.6 训练阶段数据

train phase 分栏。

progress 分栏内，`start` 按钮开始训练，`stop` 停止训练。

训练时，会显示一些进度信息。

result 分栏内，显示 loss 和 accuracy。
